<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhatsApp Football Bot Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/dashboard.css">
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
</head>

<body>
    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo">
                <div class="logo-icon">⚽</div>
                <h1>Football Bot</h1>
            </div>

            <nav class="nav">
                <button class="nav-item active" data-page="dashboard">
                    <span class="nav-icon">📊</span>
                    <span class="nav-text">דשבורד</span>
                </button>
                <button class="nav-item" data-page="groups">
                    <span class="nav-icon">👥</span>
                    <span class="nav-text">קבוצות</span>
                </button>
                <button class="nav-item" data-page="members">
                    <span class="nav-icon">🏃</span>
                    <span class="nav-text">שחקנים</span>
                </button>
                <button class="nav-item" data-page="settings">
                    <span class="nav-icon">⚙️</span>
                    <span class="nav-text">הגדרות</span>
                </button>
            </nav>

            <div class="sidebar-footer">
                <div class="status-indicator">
                    <div class="status-dot" id="connectionStatus"></div>
                    <span id="connectionText">מחבר...</span>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Page -->
            <div id="dashboardPage" class="page active">
                <div class="page-header">
                    <h2>דשבורד</h2>
                    <p class="subtitle">מצב הבוט ופעילות אחרונה</p>
                </div>

                <div class="cards-grid">
                    <!-- Bot Status -->
                    <div class="card">
                        <div class="card-header">
                            <h3>🤖 סטטוס הבוט</h3>
                        </div>
                        <div class="card-body">
                            <div class="status-item">
                                <span class="status-label">WhatsApp:</span>
                                <span class="status-value" id="botReady">⏳ טוען...</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">אימות:</span>
                                <span class="status-value" id="botAuth">⏳ טוען...</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">לקוחות מחוברים:</span>
                                <span class="status-value" id="connectedClients">0</span>
                            </div>
                        </div>
                    </div>

                    <!-- WhatsApp Controls -->
                    <div class="card">
                        <div class="card-header">
                            <h3>🔧 ניהול חיבור</h3>
                        </div>
                        <div class="card-body">
                            <button class="btn btn-danger" onclick="logoutWhatsApp()"
                                style="width: 100%; margin-bottom: 0.5rem;">
                                🚪 התנתק מ-WhatsApp
                            </button>
                            <button class="btn btn-secondary" onclick="refreshQR()" style="width: 100%;">
                                🔄 בקש QR code חדש
                            </button>
                        </div>
                    </div>

                    <!-- QR Code -->
                    <div class="card full-width" id="qrCard" style="display: none;">
                        <div class="card-header">
                            <h3>📱 QR Code</h3>
                        </div>
                        <div class="card-body center">
                            <div id="qrcode"></div>
                            <p class="qr-instructions" id="qrInstructions">פתח WhatsApp ← הגדרות ← מכשירים מקושרים ← קשר
                                מכשיר</p>
                        </div>
                    </div>

                    <!-- Activity Log -->
                    <div class="card full-width">
                        <div class="card-header">
                            <h3>📝 לוג פעילות</h3>
                        </div>
                        <div class="card-body">
                            <div class="activity-log" id="activityLog">
                                <!-- Log items will be added here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Groups Page -->
            <div id="groupsPage" class="page">
                <div class="page-header">
                    <h2>קבוצות WhatsApp</h2>
                    <p class="subtitle">בחר את הקבוצות שהבוט יפעל בהן</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>👥 הקבוצות שלך</h3>
                        <button id="refreshGroupsBtn" class="btn btn-secondary btn-sm">
                            🔄 רענן
                        </button>
                    </div>
                    <div class="card-body">
                        <div id="groupsLoading" class="loading">
                            <div class="spinner"></div>
                            <p>טוען קבוצות...</p>
                        </div>
                        <div id="groupsList" class="groups-list" style="display: none;">
                            <!-- Groups will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Members Page -->
            <div id="membersPage" class="page">
                <div class="page-header">
                    <h2>רשימת שחקנים</h2>
                    <p class="subtitle">נהל את רשימת השמות שיתווספו אוטומטית</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>🏃 השחקנים</h3>
                        <button id="addMemberBtn" class="btn btn-primary btn-sm">
                            ➕ הוסף
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="members-info">
                            <p>💡 סדר השחקנים קובע איזה שמות ימולאו קודם במקומות הפנויים</p>
                        </div>
                        <div id="membersList" class="members-list">
                            <!-- Members will be loaded here -->
                        </div>
                        <button id="saveMembersBtn" class="btn btn-primary" style="width: 100%; margin-top: 1rem;">
                            💾 שמור
                        </button>
                    </div>
                </div>
            </div>

            <!-- Settings Page -->
            <div id="settingsPage" class="page">
                <div class="page-header">
                    <h2>הגדרות</h2>
                    <p class="subtitle">התאם את התנהגות הבוט לצרכים שלך</p>
                </div>

                <div class="cards-grid">
                    <!-- Keywords -->
                    <div class="card full-width">
                        <div class="card-header">
                            <h3>🔍 מילות מפתח</h3>
                        </div>
                        <div class="card-body">
                            <p class="form-label">מילות המפתח לזיהוי רשימות כדורגל:</p>
                            <div id="keywordsList" class="keywords-list">
                                <!-- Keywords will be loaded here -->
                            </div>
                            <div class="input-group">
                                <input type="text" id="newKeyword" class="form-input"
                                    placeholder="הוסף מילת מפתח חדשה...">
                                <button id="addKeywordBtn" class="btn btn-primary">➕ הוסף</button>
                            </div>
                        </div>
                    </div>

                    <!-- Bot Behavior -->
                    <div class="card">
                        <div class="card-header">
                            <h3>⚙️ התנהגות בוט</h3>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="replyMode">
                                    💬 מצב תגובה (reply)
                                </label>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="requireConfirmation">
                                    ✋ דרוש אישור לפני שליחה
                                </label>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="addToWaitlist">
                                    📋 הוסף לרשימת ממתינים
                                </label>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="selfTestMode">
                                    🧪 מצב טסט עצמי
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Timing -->
                    <div class="card">
                        <div class="card-header">
                            <h3>⏱️ תזמון</h3>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label class="form-label">השהייה לפני שליחה (ms):</label>
                                <input type="number" id="delayMs" class="form-input" min="0" step="100">
                                <span class="form-hint">זמן המתנה באלפיות השנייה לפני שליחת תגובה</span>
                            </div>
                        </div>
                    </div>

                    <!-- Save Settings -->
                    <div class="card full-width">
                        <div class="card-body">
                            <button id="saveSettingsBtn" class="btn btn-primary" style="width: 100%;">
                                💾 שמור הגדרות
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="js/dashboard.js"></script>
</body>

</html>